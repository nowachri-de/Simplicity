<html>
  <head>
    <title>Neataptic.js - Training</title>

    <!-- Meta data -->
    <meta charset="UTF-8">

    
    <meta name="description" content="A simple tutorial on how to get started on training neural networks with Neataptic">
    

    
    <meta name="keywords" content="training, machine-learning, neural-network, backpropagation">
    

    
    <meta name="author" content="Thomas Wagenaar">
    

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="../../../custom.css">

    <!-- Favicon -->
    <link rel="shortcut icon" href="http://i.imgur.com/rPZtAOc.png">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">

    <!-- Google Analytics -->
    <script async>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-51480408-2', 'auto');
      ga('send', 'pageview');
    </script>



    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
        }
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </head>
  <body>
    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../.."><p class="brand">Neataptic</p></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="current active"><a href="../../..">Home</a></li>
            <li class="current"><a href="../../">Docs</a></li>
            <li class="current"><a href="../../../articles/">Articles</a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/wagenaartje/neataptic" target="blank"><i class="fa fa-github fa-1x"></i><b> GITHUB</b></a></li>
          </ul>
        </div>
      </div>
    </nav>

    
    <div class="container" style="margin-top: 60px">
      <div class="row">
        <!-- Sidebar -->
        <div class="col-sm-2 col-md-2 col-lg-2">
          
            <ul id="sidebar" class="nav">
              
                
            
                
                  
                    
                        
                    
                  
                    
                      <li><a href="../tutorials/">Tutorials</a></li>
                      <ul>
                      
                          <li class="active">
                              <a href="./">Training</a>
                          </li>
                      
                          <li class="">
                              <a href="../evolution/">Evolution</a>
                          </li>
                      
                          <li class="">
                              <a href="../normalization/">Normalization</a>
                          </li>
                      
                          <li class="">
                              <a href="../visualization/">Visualization</a>
                          </li>
                      
                      </ul>
                      
                  
                    
                      <li><a href="../../important/important/">Important functions</a></li>
                      <ul>
                      
                          <li class="">
                              <a href="../../important/train/">Train</a>
                          </li>
                      
                          <li class="">
                              <a href="../../important/evolve/">Evolve</a>
                          </li>
                      
                      </ul>
                      
                  
                    
                      <li><a href="../../builtins/builtins/">Built-in networks</a></li>
                      <ul>
                      
                          <li class="">
                              <a href="../../builtins/perceptron/">Perceptron</a>
                          </li>
                      
                          <li class="">
                              <a href="../../builtins/lstm/">LSTM</a>
                          </li>
                      
                          <li class="">
                              <a href="../../builtins/gru/">GRU</a>
                          </li>
                      
                          <li class="">
                              <a href="../../builtins/narx/">NARX</a>
                          </li>
                      
                          <li class="">
                              <a href="../../builtins/random/">Random</a>
                          </li>
                      
                          <li class="">
                              <a href="../../builtins/hopfield/">Hopfield</a>
                          </li>
                      
                      </ul>
                      
                  
                    
                      <li><a href="../../architecture/architecture/">Architecture</a></li>
                      <ul>
                      
                          <li class="">
                              <a href="../../architecture/construct/">Construct</a>
                          </li>
                      
                          <li class="">
                              <a href="../../architecture/network/">Network</a>
                          </li>
                      
                          <li class="">
                              <a href="../../architecture/layer/">Layer</a>
                          </li>
                      
                          <li class="">
                              <a href="../../architecture/group/">Group</a>
                          </li>
                      
                          <li class="">
                              <a href="../../architecture/node/">Node</a>
                          </li>
                      
                          <li class="">
                              <a href="../../architecture/connection/">Connection</a>
                          </li>
                      
                      </ul>
                      
                  
                    
                      <li><a href="../../methods/methods/">Methods</a></li>
                      <ul>
                      
                          <li class="">
                              <a href="../../methods/regularization/">Regularization</a>
                          </li>
                      
                          <li class="">
                              <a href="../../methods/mutation/">Mutation</a>
                          </li>
                      
                          <li class="">
                              <a href="../../methods/selection/">Selection</a>
                          </li>
                      
                          <li class="">
                              <a href="../../methods/activation/">Activation</a>
                          </li>
                      
                          <li class="">
                              <a href="../../methods/cost/">Cost</a>
                          </li>
                      
                          <li class="">
                              <a href="../../architecture/connection/">Connection</a>
                          </li>
                      
                          <li class="">
                              <a href="../../methods/gating/">Gating</a>
                          </li>
                      
                          <li class="">
                              <a href="../../methods/rate/">Rate</a>
                          </li>
                      
                      </ul>
                      
                  
                    
                        
                        <li class="">
                            <a href="../../neat/">NEAT</a>
                        </li>
                      
                    
                  
                
            
                
            
          
          </ul>
        </div>

        <!-- Content -->
        <div class="col-sm-10 col-md-10 col-lg-10 content">
          <h1 style="margin-bottom: 0px;">Training</h1>
          <p><a style="text-decoration: none" href="https://github.com/wagenaartje/neataptic/edit/master/mkdocs/templates/docs\tutorials\training.md"><i class="fa fa-github fa-1x"></i> Edit on Github</a></p>
          <hr>
          <p>Training your network is not that hard to do - it's the preparation that is harder.</p>
<h3 id="the-training-set">The training set</h3>
<p>First of all, you should normalize your data. That means you have to convert all your input and output data to values within a range of <code>0</code> to <code>1</code>. If you are unsure how to do this, visit the <a href="../normalization/">Normalization</a> page. Each training sample in your training set should be an object that looks as follows:</p>
<pre><code class="javascript">{ input: [], output: [] }
</code></pre>

<p>So an example of a training set would be (XOR):</p>
<pre><code class="javascript">var myTrainingSet = [
  { input: [0,0], output: [0] },
  { input: [0,1], output: [1] },
  { input: [1,0], output: [1] },
  { input: [1,1], output: [0] }
];
</code></pre>

<h3 id="the-network-architecture">The network architecture</h3>
<p>There is no fixed rule of thumb for choosing your network architecture. Adding more layers makes your neural network recognize more abstract relationships, although it requires more computation. Any function can be mapped with just one (big) hidden layer, but I do not advise this. I advise to use any of the following architectures if you're a starter:</p>
<ul>
<li><a href="../../builtins/perceptron/">Perceptron</a> - a fully connected feed forward network</li>
<li><a href="../../builtins/lstm/">LSTM</a> - a recurrent network that can recognize patterns over very long time lags between inputs.</li>
<li><a href="../../builtins/narx/">NARX</a> - a recurrent network that remembers previous inputs and outputs</li>
</ul>
<p>But for most problems, a perceptron is sufficient. Now you only have to determine the size and amount of the network layers. I advise you to take a look at this <a href="https://stats.stackexchange.com/questions/181/how-to-choose-the-number-of-hidden-layers-and-nodes-in-a-feedforward-neural-netw">StackExchange question</a> for more help on deciding the hidden size.</p>
<p>For the training set I provided above (XOR), there are only 2 inputs and one output. I use the rule of thumb: <code>input size + output size = hidden size</code>. So the creation of my network would like this:</p>
<pre><code class="javascript">myNetwork = architect.Perceptron(2, 3, 1);
</code></pre>

<h3 id="training-the-network">Training the network</h3>
<p>Finally: we're going to train the network. The function for training your network is very straight-forward:</p>
<pre><code class="javascript">yourNetwork.train(yourData, yourOptions);
</code></pre>

<p>There are <em>a lot</em> of options. I won't go over all of them here, but you can check out the <a href="../../architecture/network/">Network wiki</a> for all the options.</p>
<p>I'm going to use the following options:</p>
<ul>
<li><code>log: 10</code> - I want to log the status every 10 iterations</li>
<li><code>error: 0.03</code> - I want the training to stop if the error is below 0.03</li>
<li><code>iterations: 1000</code> - I want the training to stop if the error of 0.03 hasn't been reached after 1000 iterations</li>
<li><code>rate: 0.3</code> - I want a learning rate of 0.3</li>
</ul>
<p>So let's put it all together:</p>
<pre><code class="javascript">myNetwork.train(myTrainingSet, {
  log: 10,
  error: 0.03,
  iterations: 1000,
  rate: 0.3
});

// result: {error: 0.02955628620843985, iterations: 566, time: 31}
</code></pre>

<p>Now let us check if it <em>actually</em> works:</p>
<pre><code class="javascript">myNetwork.activate([0,0]); // [0.1257225731473885]
myNetwork.activate([0,1]); // [0.9371910625522613]
myNetwork.activate([1,0]); // [0.7770757408042104]
myNetwork.activate([1,1]); // [0.1639697315652196]
</code></pre>

<p>And it works! If you want it to be more precise, lower the target error.</p>
<h3 id="help">Help</h3>
<p>If you need more help, feel free to create an issue <a href="https://github.com/wagenaartje/neataptic/issues">here</a>!</p>
        </div>
      </div>
    </div>
    

    <!-- Javascript (only for blogs) -->
    
      
        
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
    

    <script>
      $("table").each(function(){
          $(this).addClass('table table-striped');
      });
      $(".current").each(function(){
        var text = $(this).text().toLowerCase();
        if(window.location.pathname.indexOf(text) >= 0){
          $('.active').removeClass('active');
          $(this).addClass('active');
        }
      })
    </script>
  </body>